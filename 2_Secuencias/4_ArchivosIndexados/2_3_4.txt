ACCION EJE_2_3_4 ES
    Ambiente
        Clave = Registro
            Cod_Curso : N(4)
        Fin_Registro

        Empleado = Registro
            Nro_Sucursal : N(4)
            Categoria : ('A','B','C')
            Nombre_Empleado : AN(120)
            Clave_E : Clave
            Tecnico : Logico
        Fin_Registro

        Curso = Registro
            Clave_C : Clave
            Nombre : AN(120)
            Fecha = Registro
                dia : 1..31
                mes : 1..12
                anio : N(4)
            Fin_Registro
            Cant_Horas : N(4)
        Fin_Registro

        Empleados : Archivo de Empleado ordenado por Nro_Sucursal, Categoria
        emp : Empleado

        Cursos : Archivo de Curso indexado por Clave_C
        cur : Curso

        cont_tec_cat, cont_notec_cat, cont_tot_cat: N(4)
        cont_tec_suc, cont_notec_suc, cont_tot_suc:N(4)
        cont_tec, cont_notec, cont_tot : N(4)

        resg_Categoria:('A','B','C')
        resg_Nro_Sucursal : N(4)

        PROCEDIMIENTO TRATAR_CORTE1 ES
            ESC("CATEGORIA:", emp.Categoria)
            ESC("tecnicos:", cont_tec_cat)
            ESC("no tecnicos:", cont_notec_cat)
            ESC("total:",cont_tot_cat)

            cont_tec_suc := cont_tec_suc + cont_tec_cat
            cont_notec_suc := cont_notec_suc + cont_notec_cat
            cont_tot_suc := cont_tot_suc + cont_tot_cat

            cont_tec_cat:=0
            cont_notec_cat:=0
            cont_tot_cat:=0

            resg_Categoria := emp.Categoria
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO TRATAR_CORTE2 ES
            TRATAR_CORTE1

            ESC("SUCURSAL:", emp.Nro_Sucursal)
            ESC("tecnicos:", cont_tec_suc)
            ESC("no tecnicos:", cont_notec_suc)
            ESC("total:",cont_tot_suc)

            cont_tec := cont_tec_suc + cont_tec
            cont_notec := cont_notec_suc + cont_notec
            cont_tot := cont_tot_suc + cont_tot

            cont_tec_suc:= 0
            cont_notec_suc:= 0
            cont_tot_suc:= 0
            resg_Nro_Sucursal := emp.Nro_Sucursal
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO TRATAR_CORTES ES
            SI resg_Nro_Sucursal <> emp.Nro_Sucursal ENTONCES
                TRATAR_CORTE2
            SINO
                SI resg_Categoria <> emp.Categoria ENTONCES
                    TRATAR_CORTE1
                Fin_Si
            Fin_Si
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO TRATAR_TODO ES
            MIENTRAS NFDA(Empleados) HACER
                MOSTRAR_EMPLEADO_CURSO
                TRATAR_CONTADORES
                LEER(Empleados, emp)
            FIN_MIENTRAS
            TRATAR_CORTE2
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO MOSTRAR_EMPLEADO_CURSO ES
            cur.Clave_C := emp.Clave_E
            LEER(Cursos, cur)
            SI EXISTE ENTONCES
                ESC(emp.Nro_Sucursal, emp.Categoria, emp.Nombre_Empleado, cur.Nombre)
            SINO
                ESC(emp.Nro_Sucursal, emp.Categoria, emp.Nombre_Empleado, "no dispone cursos")
            FIN_SI
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO TRATAR_CONTADORES ES
            SI emp.Tecnico ENTONCES
                cont_tec_cat:= cont_tec_cat+1
            SINO
                cont_notec_cat:= cont_notec_cat+1
            Fin_Si
            cont_tot_cat:=cont_tot_cat+1
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO MOSTRAR_RESULTADOS ES
            ESC("total de empleados tecnicos:",cont_tec)
            ESC("total de empleados no tecnicos:",cont_notec)
            ESC("total de empleados:",cont_tot)
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO Inicializar ES
            ABRIR E/(Empleados)
            ABRIR E/(Cursos)
            LEER(Empleados,emp)

            cont_tec_cat:=0
            cont_notec_cat:=0
            cont_tot_cat:=0

            cont_tec_suc:=0
            cont_notec_suc:=0
            cont_tot_suc:=0

            cont_tec:=0
            cont_notec:=0
            cont_tot:=0

            resg_Categoria:=emp.Categoria
            resg_Nro_Sucursal:emp.Nro_Sucursal
        FIN_PROCEDIMIENTO

        PROCEDIMIENTO Finalizar ES
            CERRAR(Empleados)
            CERRAR(Cursos)
        FIN_PROCEDIMIENTO
    Proceso
        Inicializar
        TRATAR_TODO
        MOSTRAR_RESULTADOS
        Finalizar
FIN_ACCION