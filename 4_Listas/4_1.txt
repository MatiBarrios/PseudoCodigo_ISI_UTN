/* Ejercicio 4.1
Diseñar un algoritmo para 
acceder al k-ésimo elemento de una lista,
eliminar al k-ésimo elemento de una lista,
insertar al k-ésimo elemento de una lista,

Si la lista está vacía o k está fuera de rango, invocar ERROR.
*/

ACCION Ejercicio4_1(Prim: Puntero a Nodo) ES
    Ambiente

        Nodo = Registro
            Dato : AN(60)
            prox : Puntero a Nodo
        Fin_Registro

        P, Ant, Prim, Q : Puntero a Nodo
        NumeroK, cont, sel : Entero
        msg : AN(60)

    Procedimiento ERROR(err : AN(60)) ES
        ESC("ERROR: " + err)
    Fin_Procedimiento

    Procedimiento UbicarPuntero ES

        P := Prim//SE ASIGNA EL INICIO A P
        Ant := NIL//SE INICIALIZA EL ANT COMO NUL
        cont := 1//SE GENERA EL CONTADOR
        
        Mientras (P <> NIL) Y (cont < NumeroK) HACER //SIEMPRE QUE P NO SEA NULO Y Y QUE EL CONTADOR SEA MENOR AL NUMERO QUE INGRESA
            Ant := P
            P := *P.prox
            cont := cont + 1
        Fin_Mientras

    Fin_Procedimiento

    Procedimiento Acceder ES
        Si Prim = NIL ENTONCES
            ERROR("lista vacía")
        Sino
            UbicarPuntero
            Si (P <> NIL) Y (cont = NumeroK) ENTONCES
                ESC("Dato en la posición " + NumeroK + ": " + *P.Dato)
            Sino
                ERROR("posición fuera de rango")
            Fin_Si
        Fin_Si
    Fin_Procedimiento

    Procedimiento Eliminar ES
    //caso lista vacia
        Si Prim = NIL ENTONCES
            ERROR("lista vacía")
        Sino
            UbicarPuntero
            Si (P = NIL) O (cont <> NumeroK) ENTONCES
                ERROR("posición fuera de rango")
            Sino
            //caso particular de eliminar el primer nodo
                Si Ant = NIL ENTONCES
                    // k = 1
                    Prim := *P.prox
                Sino
                    //Caso elemento del medio o ultimo
                    // k > 1 (medio o último)
                    *Ant.prox := *P.prox
                Fin_Si
                DISPONER(P)
                ESC("Dato eliminado con éxito")
            Fin_Si
        Fin_Si
    Fin_Procedimiento

    Procedimiento Insertar ES
        Si (Prim = NIL) Y (NumeroK <> 1) ENTONCES
            ERROR("lista vacía; posición fuera de rango")
        Sino
            ESC("Ingrese el dato")//PIDO QUE EL USUARIO INGRESE EL DATO PARA INSERTAR
            LEER(msg)

            NUEVO(Q)//SE CREA UN NUEVO PUNTERO
            *Q.Dato := msg //ESCRIBO EL DATO EN EL NODO
            *Q.prox := NIL

            Si NumeroK = 1 ENTONCES//CASO INSERCIÓN EN LA PRIEMERA POSICION
                *Q.prox := Prim
                Prim := Q
                ESC("Dato insertado al inicio")
            Sino
                UbicarPuntero
                Si (P <> NIL) Y (cont = NumeroK) ENTONCES
                    // Insertar antes del k-ésimo (medio)
                    *Ant.prox := Q
                    *Q.prox := P
                    ESC("Dato insertado en la posición " + NumeroK)
                Sino
                    // k = n + 1 (insertar al final)
                    Si (P = NIL) Y (cont = NumeroK) ENTONCES
                        *Ant.prox := Q
                        ESC("Dato insertado al final")
                    Sino
                        ERROR("posición fuera de rango")
                    Fin_Si
                Fin_Si
            Fin_Si
        Fin_Si
    Fin_Procedimiento

    Proceso
        //SE ASUME QUE LA LISTA VIENE CARGADA Y QUE EL NODO DE INICIO ES PRIM
        ESC("Ingrese la posición k")
        LEER(NumeroK)

        Si NumeroK < 1 ENTONCES
            ERROR("número inválido")
        Sino
            ESC("Elija: 1-Acceder, 2-Eliminar, 3-Insertar")
            LEER(sel)

            SEGUN sel HACER
                = 1:
                    Acceder
                = 2:
                    Eliminar
                = 3:
                    Insertar
                otros:
                    ERROR("selección inválida")
            FIN_SEGUN
        Fin_Si
    Fin_Proceso
FIN_ACCION